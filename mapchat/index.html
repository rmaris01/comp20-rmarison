<!DOCTYPE html>

<html>
	<head>
		<title>Map Chat</title>
 		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
 		<link rel="stylesheet" href="style.css"/>

 		<script>
 			var myLat = 0;
 			var myLong = 0;
 			var xhr = new XMLHttpRequest();
 			var myLocation = new google.maps.LatLng(myLat, myLong);
 			var options = {
 				zoom: 13, center: myLocation, mapTypeId: google.maps.MapTypeId.ROADMAP
 			};
 			var map;
 			var marker;
 			var infoWindow = new google.maps.InfoWindow();

 			function init() {
 				map = new google.maps.Map(document.getElementById("map_canvas"), options);
 				getLocation();
 			}

 			function getLocation() {
 				if (navigator.geolocation) { // the navigator.geolocation object is supported on browser
					navigator.geolocation.getCurrentPosition(function(pos) {
						console.log("hi");
						myLat = pos.coords.latitude;
						myLong = pos.coords.longitude;
						createMap();
					});
				}
				else {
					alert("Geolocation is not supported by your web browser.");
				}
 			}

 			function createMap() {
 				myLocation = new google.maps.LatLng(myLat, myLong);

 				//Update map
 				map.panTo(myLocation);

 				//Create a marker on map
 				marker = new google.maps.Marker({
 					position: myLocation, title: "My Location"
 				})
 				marker.setMap(map);

 				google.maps.event.addListener(marker, 'click', function() {
 					infoWindow.setContent(marker.title);
 					infoWindow.open(map, marker);
 				});
 			}

 		</script>

	</head>
	
	<body onload="init()">
		<div id="map_canvas"></div>
	</body>

</html>